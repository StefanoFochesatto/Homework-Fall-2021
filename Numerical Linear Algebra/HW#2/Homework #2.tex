
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
% This top part of the document is called the 'preamble'.  Modify it with caution!
%
% The real document starts below where it says 'The main document starts here'.

\documentclass[12pt]{article}

\usepackage{amssymb,amsmath,amsthm}
\usepackage[top=1in, bottom=1in, left=1.25in, right=1.25in]{geometry}
\usepackage{fancyhdr}
\usepackage{enumerate}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{float}
% Comment the following line to use TeX's default font of Computer Modern.
\usepackage{times,txfonts}



\makeatletter
\renewcommand*\env@matrix[1][*\c@MaxMatrixCols c]{%
  \hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{#1}}
\makeatother

\newtheoremstyle{homework}% name of the style to be used
  {18pt}% measure of space to leave above the theorem. E.g.: 3pt
  {12pt}% measure of space to leave below the theorem. E.g.: 3pt
  {}% name of font to use in the body of the theorem
  {}% measure of space to indent
  {\bfseries}% name of head font
  {:}% punctuation between head and body
  {2ex}% space after theorem head; " " = normal interword space
  {}% Manually specify head
\theoremstyle{homework} 

% Set up an Exercise environment and a Solution label.
\newtheorem*{exercisecore}{Exercise \@currentlabel}
\newenvironment{exercise}[1]
{\def\@currentlabel{#1}\exercisecore}
{\endexercisecore}

\newcommand{\localhead}[1]{\par\smallskip\noindent\textbf{#1}\nobreak\\}%
\newcommand\solution{\localhead{Solution:}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Stuff for getting the name/document date/title across the header
\makeatletter
\RequirePackage{fancyhdr}
\pagestyle{fancy}
\fancyfoot[C]{\ifnum \value{page} > 1\relax\thepage\fi}
\fancyhead[L]{\ifx\@doclabel\@empty\else\@doclabel\fi}
\fancyhead[C]{\ifx\@docdate\@empty\else\@docdate\fi}
\fancyhead[R]{\ifx\@docauthor\@empty\else\@docauthor\fi}
\headheight 15pt

\def\doclabel#1{\gdef\@doclabel{#1}}
\doclabel{Use {\tt\textbackslash doclabel\{MY LABEL\}}.}
\def\docdate#1{\gdef\@docdate{#1}}
\docdate{Use {\tt\textbackslash docdate\{MY DATE\}}.}
\def\docauthor#1{\gdef\@docauthor{#1}}
\docauthor{Use {\tt\textbackslash docauthor\{MY NAME\}}.}
\makeatother

% Shortcuts for blackboard bold number sets (reals, integers, etc.)
\newcommand{\Reals}{\ensuremath{\mathbb R}}
\newcommand{\Nats}{\ensuremath{\mathbb N}}
\newcommand{\Ints}{\ensuremath{\mathbb Z}}
\newcommand{\Rats}{\ensuremath{\mathbb Q}}
\newcommand{\Cplx}{\ensuremath{\mathbb C}}
%% Some equivalents that some people may prefer.
\let\RR\Reals
\let\NN\Nats
\let\II\Ints
\let\CC\Cplx

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
% The main document start here.

% The following commands set up the material that appears in the header.
\doclabel{Math 614: Homework 2}
\docauthor{Stefano Fochesatto}
\docdate{\today}

\begin{document}


\begin{exercise}{P5} This question requires nothing but calculus as a prerequisite. It shows a major source of linear systems from applications.
  \begin{enumerate}[a.]
    \item Consider these three equation, chosen for visualizability:
          \begin{equation*}
            x^2 + y^2 + z^2 = 4
          \end{equation*}
          \begin{equation*}
            x = cos(\pi y)
          \end{equation*}
          \begin{equation*}
            z = y^2
          \end{equation*}
          Provide a sketch of each equation individually as a surface in $\RR^3$. Consider where all three surfaces intersect, describe
          informally why there are two solutions. Explain why both solutions are inside the closed box $-1\leq x \leq 1$, $-2\leq y \leq 2$, and $0\leq z \leq 2$.\\
          \solution First let's consider a graph of each of the surfaces described above.
          \begin{figure}[H]
            \begin{center}
              \caption{The three proposed surfaces.}
              \includegraphics[width=.75\textwidth]{figure1.png}
            \end{center}
          \end{figure}
          Describing the solutions we can see that the ellipsoid and the parabolic cylinder intersect at a curve that looks like a taco shell (Don't know how else to describe the curve).
          When this curve is projected to the $x-y$ plane it only intersects the function $x = cos(\pi y)$ in two places. The solutions lie within $-1\leq x \leq 1$ because we are bounded by $x = cos(\pi y)$,
          $0\leq z$ because we are bounded by $z = y^2$, and $-2\leq y \leq 2$ and $z \leq 2$ because we are bounded by $x^2 + y^2 + z^2 = 4$.
          \vspace{.15in}

    \item Newton's method for a system of nonlinear equations is an iterative, approximate, and sometimes very fast, method for solving systems like the one above. Let $x =(x_1, x_2,x_3) \in \RR^3$.
          Suppose there are three scalar functions $f_i(x)$ forming a column vector function, and consider the system,
          \begin{equation*}
            f(x) = 0,
          \end{equation*}
          Also let,
          \begin{equation*}
            J_{ij} = \dfrac{\delta f_i}{\delta x_j}
          \end{equation*}
          Be the Jacobian matrix: $J \in \RR^{3x3}$. The Jacobian generally depends on location and it generalizes the ordinary scalar derivative.\\
          Newton's method itself is,
          \begin{align}
            J(x_n)s & = -f(x_n) \\
            x_{n+1} & = x_n + s
          \end{align}
          Where $s = (s_1, s_2, s_3)$ is the step and $x_0$ is the initial iterate. Using $x_0 = (-1,1,1)$ write out equation $(1)$ for the $n = 0$ for the surfaces in part $a$,
          as a concrete linear system  of three equation for the three unknown components of step $s = (s_1,s_2,s_3)$. \\
          \solution First let's form the vector function $f(x)$ with the surfaces in part a,
          \begin{equation*}
            f(x) =
            \begin{bmatrix}
              x_1^2 +x_2^2 + x_3^2 - 4 \\
              cos(\pi x_2) -x_1        \\
              x_2^2 - x_3
            \end{bmatrix}
          \end{equation*}
          Now we can consider the associated Jacobian for this system,
          \begin{equation*}
            J(x) = \begin{bmatrix}
              2x_1 & 2x_2              & 2x_3 \\
              -1   & -\pi sin(\pi x_2) & 0    \\
              0    & 2x_2              & -1
            \end{bmatrix}
          \end{equation*}
          Solving each for $x_0 = (-1,1,1)$,
          \begin{equation*}
            f(x_0) =
            \begin{bmatrix}
              -1^2 +1 + 1 - 4 \\
              cos(\pi) -(-1)  \\
              1^2 - 1
            \end{bmatrix}
            =
            \begin{bmatrix}
              -3 \\
              0  \\
              0
            \end{bmatrix}
          \end{equation*}
          \begin{equation*}
            J(x_0) =
            \begin{bmatrix}
              2(-1) & 2(1)          & 2(1) \\
              -1    & -\pi sin(\pi) & 0    \\
              0     & 2(1)          & -1
            \end{bmatrix}
            =
            \begin{bmatrix}
              -2 & 2 & 2  \\
              -1 & 0 & 0  \\
              0  & 2 & -1
            \end{bmatrix}
          \end{equation*}
          Putting everything together to form the system to solve for $s$,
          \begin{equation*}
            \begin{bmatrix}
              -2 & 2 & 2  \\
              -1 & 0 & 0  \\
              0  & 2 & -1
            \end{bmatrix}
            \begin{bmatrix}
              s_1 \\
              s_2 \\
              s_3
            \end{bmatrix}
            = -
            \begin{bmatrix}
              -3 \\
              0  \\
              0
            \end{bmatrix}
          \end{equation*}
          \vspace{.15in}

    \item Implement Newton's method in Matlab to solve the part $(a)$ nonlinear system. Show your script and
          generate at least five iterations. Use $x_0 = (-1,1,1)$ as an initial iterate to find one solution, and
          also find the other solution using a different initial iterate. Note that $format$ $long$ is appropriate here.\\
          \solution
          \textbf{Code:}
          \begin{center}
            \lstinputlisting{NewtonsMethodP5.m}
          \end{center}

          \textbf{Console:}
          \begin{center}
            \lstinputlisting{P5C.txt}
          \end{center}
          \vspace{.15in}

    \item In calculus you likely learned Newton's method as a memorized formula $x_{n+1} =x_n - f(x_n)/f'(x_n)$.
          rewrite equations $(1)$ and $(2)$ for $\RR^1$ to derive this formula.
          \solution  We can see that equation $(1)$ for $\RR^1$ is,
          \begin{equation*}
            f'(x_n)s =-f(x_n).
          \end{equation*}
          We also get that equation $(2)$ for $\RR^1$ is,
          \begin{equation*}
            x_{n+1} = x_n + s
          \end{equation*}
          Solving the first equation for $s$ and substituting into the second equation we get,
          \begin{equation*}
            x_{n+1} = x_n - \dfrac{f(x_n)}{f'(x_n)}
          \end{equation*}
  \end{enumerate}
\end{exercise}
\vspace{.25in}

\begin{exercise}{P6} Its likely that you have learned a recursive method for computing determinants called
  "expansion by minors".
  \begin{enumerate}[a.]
    \item Compute the following determinant by hand to demonstrate that you can apply expansion in minors:
          \begin{equation*}
            \left|\begin{bmatrix}
              1 & 2 & 3 \\
              4 & 5 & 6 \\
              7 & 8 & 9
            \end{bmatrix}\right|
          \end{equation*}
          \solution From what I remember we called this method co-factor expansion,
          \begin{equation*}
            \left|\begin{bmatrix}
              1 & 2 & 3 \\
              4 & 5 & 6 \\
              7 & 8 & 9
            \end{bmatrix}\right|
            = \left|\begin{bmatrix}
              5 & 6 \\
              8 & 9
            \end{bmatrix}\right|
            -2
            \left|\begin{bmatrix}
              4 & 6 \\
              7 & 9
            \end{bmatrix}\right|
            +3
            \left|\begin{bmatrix}
              4 & 5 \\
              7 & 8
            \end{bmatrix}\right|
          \end{equation*}
          \begin{equation*}
            \left|\begin{bmatrix}
              1 & 2 & 3 \\
              4 & 5 & 6 \\
              7 & 8 & 9
            \end{bmatrix}\right|
            = 5*9-8*6
            -2(4*9 - 7*6)
            +3(4*8 - 7*5)
            = 0
          \end{equation*}

  \end{enumerate}

\end{exercise}


\end{document}




















